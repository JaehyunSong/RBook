[
["visualization.html", "14. 可視化 14.1 可視化のためのパッケージ 14.2 良いグラフとは 14.3 グラフィックの文法 14.4 実習用データ 14.5 棒グラフ 14.6 ヒストグラム 14.7 散布図 14.8 図のカスタマイズ 14.9 練習問題", " 14. 可視化 14.1 可視化のためのパッケージ Rのbase graphic lattice ggplot2 14.2 良いグラフとは BBC Visual and Data Journalism cookbook for R graphics 14.3 グラフィックの文法 ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) + geom_point(aes(x = Year, y = P, color = Company_Type1), size = 3, pch = 21, fill = &quot;white&quot;) + labs(x = &quot;年度&quot;, y = &quot;平均利用者数 (人/日)&quot;, color = &quot;事業者区分&quot;) + scale_x_continuous(breaks = 2011:2017, labels = 2011:2017) + theme_gray(base_family = &quot;HiraKakuProN-W3&quot;) # 第1層: キャンバスを用意し、使用するデータはdf ggplot(data = df) 図 14.1: ggplot2の図が出来上がるまで (1) # 第2層: X軸はYear、Y軸はPにし、Company_type1ごとに色分けした折れ線グラフを作成し、線の太さは1とする。 ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) 図 14.2: ggplot2の図が出来上がるまで (2) # 第3層: X軸はYear、Y軸はPにし、Company_type1ごとに色分けした散布図を作成する。 # 点の大きさは3、点のタイプは21 (外線付き)、点の中身の色は白よする ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) + geom_point(aes(x = Year, y = P, color = Company_Type1), size = 3, pch = 21, fill = &quot;white&quot;) 図 14.3: ggplot2の図が出来上がるまで (3) # 第4層: X軸、Y軸のラベルをそれぞれ「年度」、「平均利用者数 (人/日)」に # 凡例のcolorのラベルは「事業者区分」にする ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) + geom_point(aes(x = Year, y = P, color = Company_Type1), size = 3, pch = 21, fill = &quot;white&quot;) + labs(x = &quot;年度&quot;, y = &quot;平均利用者数 (人/日)&quot;, color = &quot;事業者区分&quot;) 図 14.4: ggplot2の図が出来上がるまで (4) # 第5層: 連続変数で構成されたX軸を調整する # 目盛りは2011, 2012, ..., 2017とし、ラベルも2011, 2012, ..., 2017に ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) + geom_point(aes(x = Year, y = P, color = Company_Type1), size = 3, pch = 21, fill = &quot;white&quot;) + labs(x = &quot;年度&quot;, y = &quot;平均利用者数 (人/日)&quot;, color = &quot;事業者区分&quot;) + scale_x_continuous(breaks = 2011:2017, labels = 2011:2017) 図 14.5: ggplot2の図が出来上がるまで (5) # 第6層: テーマをminimalに指定し、フォント群はHiraKakuProN-W3に ggplot(data = df) + geom_line(aes(x = Year, y = P, color = Company_Type1), size = 1) + geom_point(aes(x = Year, y = P, color = Company_Type1), size = 3, pch = 21, fill = &quot;white&quot;) + labs(x = &quot;年度&quot;, y = &quot;平均利用者数 (人/日)&quot;, color = &quot;事業者区分&quot;) + scale_x_continuous(breaks = 2011:2017, labels = 2011:2017) + theme_minimal(base_family = &quot;HiraKakuProN-W3&quot;) 図 14.6: ggplot2の図が出来上がるまで (6) 図 14.7: ggplot2の図が出来上がるまで (全体像) 14.4 実習用データ 全国の鉄道駅データ 9150駅の情報を収録 駅の地理的情報、路線、事業者情報 2011年度から2017年度までの利用者数 (人/日) library(tidyverse) df &lt;- read_csv(&quot;Data/Stations.csv&quot;) df 変数名 説明 詳細 ID 駅ID Station_Name 駅名 Pref 所在地 都道府県 (ID) Zipcode 所在地 郵便番号 Address 所在地 住所 Longitude 経度 Latitude 緯度 Station_Status 駅の状態 0:運用中 / 1:運用前 / 2:廃止 Line_ID 路線ID Line_Name 路線名 Line_Status 路線の状態 0:運用中 / 1:運用前 / 2:廃止 Company_ID 事業者ID Company_Name 事業者名 Company_Type1 事業者タイプ1 0:その他 / 1:JR / 2:大手私鉄 / 3:準大手私鉄 Company_Type2 事業者タイプ2 1:JR / 2:公営 / 3:民営 / 4:第三セクター Company_Status 事業者の状態 0:運用中 / 1:運用前 / 2:廃止 P2011 2011年度利用者数 単位は(人/日) P2012 2012年度利用者数 単位は(人/日) P2013 2013年度利用者数 単位は(人/日) P2014 2014年度利用者数 単位は(人/日) P2015 2015年度利用者数 単位は(人/日) P2016 2016年度利用者数 単位は(人/日) P2017 2017年度利用者数 単位は(人/日) 利用者数の情報は国土交通省の国土数値情報「駅別乗降客数データ」から、その他の情報は「駅データ.jp」から入手したものです。両データの結合は緯度と経度を基準にマッチングし、駅名が一致するケースのみ残したものです。したがって、不正確にマッチングされたケースが存在する可能性があります（とりわけ乗換駅など）。この実習用データを使って、何らかの意味のある分析はできません。あくまでも実習用データとしてお使いください。 14.5 棒グラフ 14.6 ヒストグラム 14.7 散布図 14.8 図のカスタマイズ 14.9 練習問題 dfを用い、以下のような図を作成せよ。 "]
]
