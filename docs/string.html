<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.161">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>私たちのR - 18&nbsp; 文字列の処理</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./visualization1.html" rel="next">
<link href="./tidydata.html" rel="prev">
<link href="./Figs/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "サーチ"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CEHS4C056W"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CEHS4C056W', { 'anonymize_ip': false});
</script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&amp;display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Mono&amp;display=swap" rel="stylesheet"> 


<meta property="og:title" content="私たちのR: ベストプラクティスの探求">
<meta property="og:description" content="R Not for Everyone: An Esoteric Guide">
<meta property="og:image" content="https://www.jaysong.net/RBook/Figs/favicon.png">
<meta property="og:site_name" content="私たちのR">
<meta property="og:image:height" content="260">
<meta property="og:image:width" content="260">
<meta name="twitter:title" content="私たちのR: ベストプラクティスの探求">
<meta name="twitter:description" content="R Not for Everyone: An Esoteric Guide">
<meta name="twitter:image" content="https://www.jaysong.net/RBook/Figs/favicon.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:image-height" content="260">
<meta name="twitter:image-width" content="260">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./datahandling1.html">データハンドリング</a></li><li class="breadcrumb-item"><a href="./string.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">文字列の処理</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="サイドバーを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">私たちのR</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JaehyunSong/RBook/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="サーチ"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">紹介</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rの導入</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aboutr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rのインストール</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">IDEの導入</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_customize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">分析環境のカスタマイズ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rパッケージ</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Rの基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">プロジェクト管理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">基本的な操作</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./io.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">データの入出力</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datatype.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">データ型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datastructure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">データ構造</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Rプログラミングの基礎</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">関数の自作</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">データハンドリング</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datahandling1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">データハンドリング [抽出]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datahandling2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">データハンドリング [要約]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datahandling3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">データハンドリング [拡張]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">データハンドリング [factor型]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidydata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">整然データ構造</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./string.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">文字列の処理</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">可視化</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">可視化 [理論]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">可視化 [基礎]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">可視化 [応用]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">可視化 [発展]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">表の作成</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">再現可能な研究</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">R Markdown [基礎]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rmarkdown2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">R Markdown [応用]</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Quarto入門</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./renv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">分析環境の管理</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">中級者向け</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">反復処理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./oop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">オブジェクト指向プログラミング</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">モンテカルロ・シミュレーション</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">スクレイピング</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">付録</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="セクションを切り替え">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">データセット</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filesystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ファイルシステム</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tips.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">本書の執筆環境</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目次</h2>
   
  <ul>
  <li><a href="#rにおける文字列" id="toc-rにおける文字列" class="nav-link active" data-scroll-target="#rにおける文字列"><span class="header-section-number">18.1</span> Rにおける文字列</a></li>
  <li><a href="#文字列の操作" id="toc-文字列の操作" class="nav-link" data-scroll-target="#文字列の操作"><span class="header-section-number">18.2</span> 文字列の操作</a></li>
  <li><a href="#正規表現" id="toc-正規表現" class="nav-link" data-scroll-target="#正規表現"><span class="header-section-number">18.3</span> 正規表現</a>
  <ul class="collapse">
  <li><a href="#一般的なパタン一致" id="toc-一般的なパタン一致" class="nav-link" data-scroll-target="#一般的なパタン一致"><span class="header-section-number">18.3.1</span> 一般的なパタン一致</a></li>
  <li><a href="#文字列操作の例" id="toc-文字列操作の例" class="nav-link" data-scroll-target="#文字列操作の例"><span class="header-section-number">18.3.2</span> 文字列操作の例</a></li>
  </ul></li>
  <li><a href="#文書データの分析" id="toc-文書データの分析" class="nav-link" data-scroll-target="#文書データの分析"><span class="header-section-number">18.4</span> 文書データの分析</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-string" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">文字列の処理</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>この章で使うパッケージを読み込む。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="rにおける文字列" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="rにおける文字列"><span class="header-section-number">18.1</span> Rにおける文字列</h2>
<p>　Rは数値だけでなく文字列 (string) も扱うことができる。近年、文字や文書をデータとして扱う機会が増えており、文字列を効率的に処理する方法を身につけることで、データとして扱う対象を拡大することができる。</p>
<p>　まず、最も基本的な文字列の扱い方を確認（復習）しよう（第<a href="datatype.html" class="quarto-xref"><span>9</span></a>章も参照されたい）。Rで文字列を使う際は、文字列を引用符 (quotation marks) で<strong>囲む</strong>（囲むというのは、文字列が始まる前とそれが終わった後にそれぞれ引用符をつけるという意味である）。例えば、「SONG Jaehyun」という文字列を<code>author1</code>というオブジェクトに格納するには、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>author1 <span class="ot">&lt;-</span> <span class="st">"SONG Jaehyun"</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>author1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SONG Jaehyun"</code></pre>
</div>
</div>
<p>文字列の中にスペースが含まれる場合、そのスペースもそのまま保存される。この例では、半角スペースを1つ含む文字列が保存される。</p>
<p>　Rにおける文字列は、<code>character</code> クラス・型として扱われる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">class</span>(author1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">is.character</span>(author1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">typeof</span>(author1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">mode</span>(author1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>　引用符は、二重引用符<code>""</code> でも 単一引用符<code>''</code> でも良い。ただし、同じ記号をペアで使う必要がある。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>author2 <span class="ot">&lt;-</span> <span class="st">'矢内　勇生'</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">print</span>(author2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "矢内　勇生"</code></pre>
</div>
</div>
<p>この例では、全角スペースを1つ含む文字列が保存される。また、<code>''</code>を使って文字列を作ったのに、表示結果で文字列を囲む引用符は<code>""</code>に変わっていることがわかる。これは、文字列を作る際には二重引用符を使うことが想定されているためである。よって、特にこだわりがなければ、二重引用符<code>""</code>を使ったほうがよいだろう。</p>
<p>　引用符自体を文字列の一部として保存したいときは、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>quote1 <span class="ot">&lt;-</span> <span class="st">"Mura'Kamisama'"</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>quote2 <span class="ot">&lt;-</span> <span class="st">'We we"R"e born to use "R."'</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>quote1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mura'Kamisama'"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>quote2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "We we\"R\"e born to use \"R.\""</code></pre>
</div>
</div>
<p><code>quote2</code> の表示結果を見ると、文字列に含まれる二重引用符の前にバックスラッシュ <code>\</code> が付いている。これは、文字列のエスケープと呼ばれる方法である。これについては後で詳しく説明する。この例においては、二重引用符を文字列を作るための命令として使う代わりに、単なる1つの文字として扱うために必要な処理である。<code>cat()</code>を使うと、保存した内容をそのまま表示することができる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">cat</span>(quote2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We we"R"e born to use "R."</code></pre>
</div>
</div>
<p>　上の例では文字列内で二重引用符を使うので、文字列の外側ではは単一引用符を使った。 二重引用符のみで上と同じ文字列を作りたい場合は、エスケープ処理を利用すればよい。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>quote3 <span class="ot">&lt;-</span> <span class="st">"We we</span><span class="sc">\"</span><span class="st">R</span><span class="sc">\"</span><span class="st">e born to use </span><span class="sc">\"</span><span class="st">R.</span><span class="sc">\"</span><span class="st">"</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>quote3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "We we\"R\"e born to use \"R.\""</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">cat</span>(quote3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We we"R"e born to use "R."</code></pre>
</div>
</div>
<p>エスケープ処理をしないとエラーになる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>quote3 <span class="ot">&lt;-</span> <span class="st">"We we"</span>R<span class="st">"e born to use "</span>R.<span class="st">""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: malformed raw string literal (&lt;text&gt;:1:20)</code></pre>
</div>
</div>
<p>これは、「“We we”」で二重引用符のペアが完成し、そのすぐ後の「R」が文字列として認識されていないために起こるエラーである。</p>
<p>　文字列を要素とするベクトルやリストなども、数値を要素とする場合と同じように作ることができる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>authors <span class="ot">&lt;-</span> <span class="fu">c</span>(author1, author2, <span class="st">"Super Cat"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>authors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SONG Jaehyun" "矢内　勇生"   "Super Cat"   </code></pre>
</div>
</div>
<p>　数値と文字列の両者を要素としてもつベクトルを作ると、すべての要素が文字として保存される。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>numchar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"three"</span>, <span class="dv">4</span>, <span class="st">"five"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>numchar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"     "2"     "three" "4"     "five" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">class</span>(numchar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">sapply</span>(numchar, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           2       three           4        five 
"character" "character" "character" "character" "character" </code></pre>
</div>
</div>
<p>Rでは、ベクトルのすべての要素は同じクラスになる。数値は文字として扱える一方で、一般的に文字を数値として扱うことはできないので、型が文字 (character) に統一される。</p>
<p>　リストは異なる型を保存することできる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>numchar_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"three"</span>, <span class="dv">4</span>, <span class="st">"five"</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>numchar_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] "three"

[[4]]
[1] 4

[[5]]
[1] "five"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">class</span>(numchar_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">lapply</span>(numchar_list, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "numeric"

[[2]]
[1] "numeric"

[[3]]
[1] "character"

[[4]]
[1] "numeric"

[[5]]
[1] "character"</code></pre>
</div>
</div>
<p>数値を文字として扱いたいときは、<code>as.character()</code> を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>one <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a>one</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>one2ten <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">as.character</span>()</span>
<span id="cb42-3"><a href="#cb42-3"></a>one2ten</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">class</span>(one2ten)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>保存されているのが数字であっても、それが文字列として保存されているなら、そのまま計算に利用することはできない。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">sum</span>(one2ten)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in sum(one2ten): invalid 'type' (character) of argument</code></pre>
</div>
</div>
<p>しかし，<code>as.numeric()</code> や <code>as.integer()</code> を使って数値に変換すれば、計算に利用することができる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">as.numeric</span>(one2ten)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>one2ten <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">as.integer</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">as.numeric</span>(<span class="st">"3.35"</span>) <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="st">"4.24"</span>) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.83</code></pre>
</div>
</div>
<p>数字以外の文字を数値に変換することはできない（<code>NA</code>になる）。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"three"</span>, <span class="st">"4"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">as.integer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2 NA  4</code></pre>
</div>
</div>
<p>　Rの文字列に対して、そのままスライシング操作を行うことはできない。たとえば、<code>author1</code>の1文字目を取り出したいときに、次のようにしても1文字目の”S”は抽出できない。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>author1[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SONG Jaehyun"</code></pre>
</div>
</div>
<p>このように、文字列全体が取り出されてしまう。これは、この文字列が長さ1のベクトル（つまり、冗長に書けば<code>c("SONG Jaehyun")</code> である）なので、スライス操作で1番目の要素を取り出すと、ベクトルの第1要素が取り出されるためである。</p>
<p>したがって、文字列自体の長さを<code>length()</code>で測ることはできない。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">length</span>(author1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">length</span>(author2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>いずれの結果も1になるのは、どちらも長さが1のベクトルだからである。</p>
<p>　文字列に対して様々な処理を施す方法については、次節で説明する。</p>
</section>
<section id="文字列の操作" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="文字列の操作"><span class="header-section-number">18.2</span> 文字列の操作</h2>
<p>Rでは、文字列に対して様々な処理を行うこができる。 文字列操作をする際に欠かせないのが、<strong>stringr</strong>パッケージである。 このパッケージは私たちが住む<strong>tidyverse</strong>に含まれているので、あらためて読み込む必要はない。</p>
<p><strong>stringr</strong>パッケージで文字列操作を行う関数は、<code>str_xxx()</code>のような形式の関数である（<code>xxx</code>の部分を、操作に応じて変える）。まず、文字列の長さ（つまり、文字数）を数えるために、<code>str_length()</code> を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">str_length</span>(authors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12  5  9</code></pre>
</div>
</div>
<p>スペースを含む文字数が返される。</p>
<p>　上で試みたように文字列の一部 (substring) を取り出すときは、<code>str_sub()</code>を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">str_sub</span>(author1, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "S"</code></pre>
</div>
</div>
<p>このように始点 (<code>start</code>) と終点 (<code>end</code>) を指定することで、文字列の一部を取り出すことができる。 5文字目から8文字目までを取り出してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">str_sub</span>(author1, <span class="at">start =</span> <span class="dv">6</span>, <span class="at">end =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jae"</code></pre>
</div>
</div>
<p>特定の位置より後をすべて取り出したいときは、<code>start</code>のみを指定する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">str_sub</span>(author1, <span class="at">start =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jaehyun"</code></pre>
</div>
</div>
<p>同様に、特定の位置までを取り出したいときは、<code>end</code>のみを指定する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">str_sub</span>(author1, <span class="at">end =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SONG"</code></pre>
</div>
</div>
<p><code>end</code> に指定した位置も含めて抽出されることに注意されたい。</p>
<p>文字列を分割 (split) したいときは、<code>str_split()</code>を使う。 <code>pattern</code>で指定した文字の前後で文字列を分割する。 たとえば、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>author1_s <span class="ot">&lt;-</span> <span class="fu">str_split</span>(author1, <span class="at">pattern =</span> <span class="st">" "</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "SONG"    "Jaehyun"</code></pre>
</div>
</div>
<p>結果として返されるのは、リストである。 2つ以上の文字列に対して同様の操作を行うと、リストで返される理由がわかるだろう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>authors_s1 <span class="ot">&lt;-</span> <span class="fu">str_split</span>(authors, <span class="at">pattern =</span> <span class="st">" "</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "SONG"    "Jaehyun"

[[2]]
[1] "矢内　勇生"

[[3]]
[1] "Super" "Cat"  </code></pre>
</div>
</div>
<p><code>authors</code> は3つの文字列を要素としてもつベクトルである。 このベクトルに対して文字列分割の操作を行うと、それぞれの文字列の分割結果を要素とするリストが返される。そしてリストの各要素の中に、分割したそれぞれの文字列を要素をしてもつベクトルが保存される。</p>
<p>　ここで、リストの2つ目の要素が分割されて<strong>いない</strong>ことに注意してほしい。これは、この文字列には半角スペースがないからだ。代わりに全角スペースがあるので、これを分割したいなら<code>pattern</code>に全角スペースを指定する必要がある。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>authors_s2 <span class="ot">&lt;-</span> <span class="fu">str_split</span>(authors, <span class="at">pattern =</span> <span class="st">"　"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "SONG Jaehyun"

[[2]]
[1] "矢内" "勇生"

[[3]]
[1] "Super Cat"</code></pre>
</div>
</div>
<p>今度は、2番目の文字列のみ分割された。すべて分割するには、<code>|</code> (or) を使って次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>authors_s3 <span class="ot">&lt;-</span> <span class="fu">str_split</span>(authors, <span class="at">pattern =</span> <span class="st">" |　"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "SONG"    "Jaehyun"

[[2]]
[1] "矢内" "勇生"

[[3]]
[1] "Super" "Cat"  </code></pre>
</div>
</div>
<p>上のコードでは、<code>|</code> の左側に半角スペース、右側に全角スペースが指定されている。</p>
<p>　あるいは、次のように「空白文字」を<code>\\s</code>で指定すれば、半角・全角をまとめて扱える（これについては後で正規表現を説明する際にもう少し説明する）。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>authors_s3 <span class="ot">&lt;-</span> <span class="fu">str_split</span>(authors, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "SONG"    "Jaehyun"

[[2]]
[1] "矢内" "勇生"

[[3]]
[1] "Super" "Cat"  </code></pre>
</div>
</div>
<p>　文字列操作をもう少し練習するために、以下の例文を使おう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>eg_Acton <span class="ot">&lt;-</span> <span class="st">"Power tends to corrupt. Absolute power corrupts absolutely."</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>eg_Wilde <span class="ot">&lt;-</span> <span class="st">"A little sincerity is a dangerous thing, and a great deal of it is absolutely fatal."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>　<code>str_split()</code>は、同じパタンが複数回出てくる場合には、すべてを分割してくれる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">str_split</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "Power"       "tends"       "to"          "corrupt."    "Absolute"   
[6] "power"       "corrupts"    "absolutely."</code></pre>
</div>
</div>
<p>この例からわかるとおり、このような操作は英文をはじめとする単語間にスペースがある言語データをに対し、文字列を単語に分割する際に有用である。</p>
<p>　特定の文字（単語）を抽出したいときは、<code>str_extract()</code> を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">str_extract</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"corrupt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "corrupt"</code></pre>
</div>
</div>
<p><code>eg_Acton</code>オブジェクトには指定した文字列である “corrupt” に一致する部分があるので、関数は指定した文字列そのものを返す。 このオブジェクトには “corrupt” という文字列が2回登場するが、この関数は最初の “corrupt” を発見した時点でそれを返し、2つ目の”corrupt” には到達しない。</p>
<p>　オブジェクトの中に指定した文字列が存在しない場合、<code>NA</code>が返される。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">str_extract</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"cats"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>　<code>str_extract()</code> は指定した文字列を1度しか返さないが、<code>str_extract_all()</code> は一致したものをすべてを返す。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">str_extract_all</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"corrupt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "corrupt" "corrupt"</code></pre>
</div>
</div>
<p>この例が示す通り、 <code>str_extract_all()</code> はリストを返す。 リストの長さは文字列が一致した回数ではなく、パタンを探す対象として渡したオブジェクトの数である。 上の例では、1つのオブジェクトで2回マッチしているので、返されたリストの長さは1であり、リストの第1要素の長さは2である。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>list_corrupt <span class="ot">&lt;-</span> <span class="fu">str_extract_all</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"corrupt"</span>) </span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="fu">length</span>(list_corrupt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="fu">length</span>(list_corrupt[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>　次の例では、返されるリストの長さが2になる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>list_absolute <span class="ot">&lt;-</span> <span class="fu">str_extract_all</span>(<span class="fu">c</span>(eg_Acton, eg_Wilde), </span>
<span id="cb96-2"><a href="#cb96-2"></a>                                 <span class="at">pattern =</span> <span class="st">"absolute"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb96-3"><a href="#cb96-3"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "absolute"

[[2]]
[1] "absolute"</code></pre>
</div>
</div>
<p>　これらの関数は、いずれも大文字と小文字を区別する (case-sensitive)。大文字、小文字の別を無視したいときは<code>regex()</code>を使って<code>ignore_case = TRUE</code> を指定する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">str_extract_all</span>(<span class="fu">c</span>(eg_Acton, eg_Wilde),</span>
<span id="cb98-2"><a href="#cb98-2"></a>                <span class="at">pattern =</span> <span class="fu">regex</span>(<span class="st">"absolute"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "Absolute" "absolute"

[[2]]
[1] "absolute"</code></pre>
</div>
</div>
<p>　オブジェクトの「先頭で」特定の文字列に一致するものを見つけたいときは、<code>^</code> (the caret symbol) を次のように使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">str_extract</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"^corrupt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">str_extract</span>(eg_Acton, <span class="at">pattern =</span> <span class="st">"^Power"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Power"</code></pre>
</div>
</div>
<p>同様に、文字列の「末尾で」一致を探すときは、<code>$</code> を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">str_extract_all</span>(<span class="fu">c</span>(eg_Acton, eg_Wilde), <span class="at">pattern =</span> <span class="st">".$"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "."

[[2]]
[1] "."</code></pre>
</div>
</div>
</section>
<section id="正規表現" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="正規表現"><span class="header-section-number">18.3</span> 正規表現</h2>
<p>　ウェブ上に存在するデータのほとんどはテキスト（文字）である。また、その大部分はデータセットとして利用可能な状態に構造化されていない。構造化されていない文字の集合そのものをデータとして利用する場合もあるが、たいていの場合、特定のパタンに合致する文字情報だけを取り出して利用したい。 よって、文字列の中から特定のパタンに当てはまるものを見つけてそれを取り出す必要がある。そのために使われるのが、<strong>正規表現 (regular expressions)</strong> である。</p>
<p>　ここでは、基本的な正規表現を紹介する。</p>
<section id="一般的なパタン一致" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="一般的なパタン一致"><span class="header-section-number">18.3.1</span> 一般的なパタン一致</h3>
<p>　ここまでは、特定の文字列に一致する文字列を見つけてきた。 しかし、正規表現を使うと、より一般的なパタンに一致する文字列を見つけることができる。 たとえば、<code>.</code> (dot) は正規表現ではあらゆる文字 (character) と一致する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">"i."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "it" "in" "it" "is" "in" "it" "is"</code></pre>
</div>
</div>
<p>ドット自体を取り出したいときは、バックスラッシュ と一緒にして <code>\.</code> とする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "."</code></pre>
</div>
</div>
<p>ここで、バックスラッシュ (<code>\</code>) はRで定義された文字列の意味から私たちを逃してくれるので、 エスケープ文字 (escape character) と呼ばれる。R（やその他の多くのプログラミング言語における正規表現）において <code>.</code> は「あらゆる文字」を意味するが、<code>\.</code> はその意味から私たちを解放し、ドットそのものとの一致を探してくれる。 ただし、バックスラッシュ自体が正規表現のバックスラッシュであることをRに伝えるために、バックスラッシュを二重にする必要がある。</p>
<p>　“it” または “in”を見つけるには次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">"i[tn]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "it" "in" "it" "in" "it"</code></pre>
</div>
</div>
<p>つまり、<code>[]</code> で囲まれ文字のうちいずれかが入るパタンで一致を探す。</p>
<p>パタンではなく、単語としての “it” と “in” のみを抜き出す（たとえば、littleに含まれる “it” は除く）には、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">bi[tn]</span><span class="sc">\\</span><span class="st">b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "it"</code></pre>
</div>
</div>
<p><code>\b</code>は、そこが単語の境界 (boundary) であることを示す。</p>
<p>ある文字<strong>以外</strong>を指定したいとき、たとえば、i から始まりt以外で終わる2文字の単語は、<code>[^]</code>を使って次のようにして取り出せる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">bi[^t]</span><span class="sc">\\</span><span class="st">b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "is" "is"</code></pre>
</div>
</div>
<p>　これらの例からわかるように、正規表現を使えば様々な条件にあった文字列を探し出すことができる。 <a href="#tbl-regex1" class="quarto-xref">表&nbsp;<span>18.1</span></a> に、よく使う正規表現のパタンを示す。</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-regex1" class="anchored">
<div id="jwhieqjxwu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jwhieqjxwu table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jwhieqjxwu thead, #jwhieqjxwu tbody, #jwhieqjxwu tfoot, #jwhieqjxwu tr, #jwhieqjxwu td, #jwhieqjxwu th {
  border-style: none;
}

#jwhieqjxwu p {
  margin: 0;
  padding: 0;
}

#jwhieqjxwu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jwhieqjxwu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jwhieqjxwu .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jwhieqjxwu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jwhieqjxwu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jwhieqjxwu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwhieqjxwu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jwhieqjxwu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jwhieqjxwu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jwhieqjxwu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jwhieqjxwu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jwhieqjxwu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jwhieqjxwu .gt_spanner_row {
  border-bottom-style: hidden;
}

#jwhieqjxwu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jwhieqjxwu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jwhieqjxwu .gt_from_md > :first-child {
  margin-top: 0;
}

#jwhieqjxwu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jwhieqjxwu .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jwhieqjxwu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jwhieqjxwu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jwhieqjxwu .gt_row_group_first td {
  border-top-width: 2px;
}

#jwhieqjxwu .gt_row_group_first th {
  border-top-width: 2px;
}

#jwhieqjxwu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwhieqjxwu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jwhieqjxwu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jwhieqjxwu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwhieqjxwu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwhieqjxwu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jwhieqjxwu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jwhieqjxwu .gt_striped {
  background-color: #FAFAFA;
}

#jwhieqjxwu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jwhieqjxwu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jwhieqjxwu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwhieqjxwu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jwhieqjxwu .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jwhieqjxwu .gt_left {
  text-align: left;
}

#jwhieqjxwu .gt_center {
  text-align: center;
}

#jwhieqjxwu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jwhieqjxwu .gt_font_normal {
  font-weight: normal;
}

#jwhieqjxwu .gt_font_bold {
  font-weight: bold;
}

#jwhieqjxwu .gt_font_italic {
  font-style: italic;
}

#jwhieqjxwu .gt_super {
  font-size: 65%;
}

#jwhieqjxwu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jwhieqjxwu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jwhieqjxwu .gt_indent_1 {
  text-indent: 5px;
}

#jwhieqjxwu .gt_indent_2 {
  text-indent: 10px;
}

#jwhieqjxwu .gt_indent_3 {
  text-indent: 15px;
}

#jwhieqjxwu .gt_indent_4 {
  text-indent: 20px;
}

#jwhieqjxwu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>表&nbsp;18.1:  <p>よく使う正規表現</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="正規表現">正規表現</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="意味">意味</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="正規表現" class="gt_row gt_left">[:digit:]</td>
<td headers="意味" class="gt_row gt_left">数字（0, 1, 2, ..., 9）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">[:lower:]</td>
<td headers="意味" class="gt_row gt_left gt_striped">小文字（a, b, c, ..., z）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">[:upper:]</td>
<td headers="意味" class="gt_row gt_left">大文字（A, B, C, ..., Z）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">[:alpha:]</td>
<td headers="意味" class="gt_row gt_left gt_striped">アルファベット (a, b, ..., z と A, B, ..., Z</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">[:alnum:]</td>
<td headers="意味" class="gt_row gt_left">アルファベットと数字（a, ..., z, A, ..., Z, 0, ..., 9）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">[:punct:]</td>
<td headers="意味" class="gt_row gt_left gt_striped">パンクチュエーション文字（! " # $ % &amp; ’ ( ) * + , - . /）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">[:blank:]</td>
<td headers="意味" class="gt_row gt_left">空白文字（スペースとタブ）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">[:space:]</td>
<td headers="意味" class="gt_row gt_left gt_striped">スペース文字（スペース、タブ、改行など）</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">[:print:]</td>
<td headers="意味" class="gt_row gt_left">印刷可能な文字 ([:alnum:], [:punct:], [:space:])</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>また、特別な意味をもつ記号を <a href="#tbl-regex2" class="quarto-xref">表&nbsp;<span>18.2</span></a> に示す。 これらを使うときには <code>\\w</code> のようにバックスラッシュを1つ増やす必要がある。</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-regex2" class="anchored">
<div id="ldqacxqhzu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ldqacxqhzu table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ldqacxqhzu thead, #ldqacxqhzu tbody, #ldqacxqhzu tfoot, #ldqacxqhzu tr, #ldqacxqhzu td, #ldqacxqhzu th {
  border-style: none;
}

#ldqacxqhzu p {
  margin: 0;
  padding: 0;
}

#ldqacxqhzu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ldqacxqhzu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ldqacxqhzu .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ldqacxqhzu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ldqacxqhzu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldqacxqhzu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldqacxqhzu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ldqacxqhzu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ldqacxqhzu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ldqacxqhzu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ldqacxqhzu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ldqacxqhzu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ldqacxqhzu .gt_spanner_row {
  border-bottom-style: hidden;
}

#ldqacxqhzu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ldqacxqhzu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ldqacxqhzu .gt_from_md > :first-child {
  margin-top: 0;
}

#ldqacxqhzu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ldqacxqhzu .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ldqacxqhzu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ldqacxqhzu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ldqacxqhzu .gt_row_group_first td {
  border-top-width: 2px;
}

#ldqacxqhzu .gt_row_group_first th {
  border-top-width: 2px;
}

#ldqacxqhzu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldqacxqhzu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ldqacxqhzu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ldqacxqhzu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldqacxqhzu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldqacxqhzu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ldqacxqhzu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ldqacxqhzu .gt_striped {
  background-color: #FAFAFA;
}

#ldqacxqhzu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ldqacxqhzu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldqacxqhzu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldqacxqhzu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ldqacxqhzu .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ldqacxqhzu .gt_left {
  text-align: left;
}

#ldqacxqhzu .gt_center {
  text-align: center;
}

#ldqacxqhzu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ldqacxqhzu .gt_font_normal {
  font-weight: normal;
}

#ldqacxqhzu .gt_font_bold {
  font-weight: bold;
}

#ldqacxqhzu .gt_font_italic {
  font-style: italic;
}

#ldqacxqhzu .gt_super {
  font-size: 65%;
}

#ldqacxqhzu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ldqacxqhzu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ldqacxqhzu .gt_indent_1 {
  text-indent: 5px;
}

#ldqacxqhzu .gt_indent_2 {
  text-indent: 10px;
}

#ldqacxqhzu .gt_indent_3 {
  text-indent: 15px;
}

#ldqacxqhzu .gt_indent_4 {
  text-indent: 20px;
}

#ldqacxqhzu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>表&nbsp;18.2:  <p>特別な意味をもつ記号</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="正規表現">正規表現</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="意味">意味</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="正規表現" class="gt_row gt_left">\w</td>
<td headers="意味" class="gt_row gt_left">文字</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">\W</td>
<td headers="意味" class="gt_row gt_left gt_striped">文字以外</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">\s</td>
<td headers="意味" class="gt_row gt_left">スペース文字</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">\S</td>
<td headers="意味" class="gt_row gt_left gt_striped">スペース文字以外</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">\d</td>
<td headers="意味" class="gt_row gt_left">数字</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">\D</td>
<td headers="意味" class="gt_row gt_left gt_striped">数字以外</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">\b</td>
<td headers="意味" class="gt_row gt_left">単語の境界</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">\B</td>
<td headers="意味" class="gt_row gt_left gt_striped">単語の境界以外</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">\&lt;</td>
<td headers="意味" class="gt_row gt_left">単語の先頭</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">\&gt;</td>
<td headers="意味" class="gt_row gt_left gt_striped">単語の末尾</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left">^</td>
<td headers="意味" class="gt_row gt_left">文字列の先頭</td></tr>
    <tr><td headers="正規表現" class="gt_row gt_left gt_striped">$</td>
<td headers="意味" class="gt_row gt_left gt_striped">文字列の末尾</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>　これらの正規表現を組み合わせて使うことで、様々なパタンに一致する文字列を探したり、抜き出したり、入れ替えたりすることができる。さらに、それぞれの正規表現に一致する回数も指定することができる。たとえば、5文字の単語を探すには、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">str_extract_all</span>(eg_Wilde, <span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">b[:alpha:]{5}</span><span class="sc">\\</span><span class="st">b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "thing" "great" "fatal"</code></pre>
</div>
</div>
<p>数を指定するときは、 <a href="#tbl-regex1" class="quarto-xref">表&nbsp;<span>18.1</span></a>　に示す限量詞 (quantifier) を登場回数を指定したい表現の直後につける。</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-regex3" class="anchored">
<div id="meiypdjgbj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#meiypdjgbj table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#meiypdjgbj thead, #meiypdjgbj tbody, #meiypdjgbj tfoot, #meiypdjgbj tr, #meiypdjgbj td, #meiypdjgbj th {
  border-style: none;
}

#meiypdjgbj p {
  margin: 0;
  padding: 0;
}

#meiypdjgbj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#meiypdjgbj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#meiypdjgbj .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#meiypdjgbj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#meiypdjgbj .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#meiypdjgbj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#meiypdjgbj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#meiypdjgbj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#meiypdjgbj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#meiypdjgbj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#meiypdjgbj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#meiypdjgbj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#meiypdjgbj .gt_spanner_row {
  border-bottom-style: hidden;
}

#meiypdjgbj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#meiypdjgbj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#meiypdjgbj .gt_from_md > :first-child {
  margin-top: 0;
}

#meiypdjgbj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#meiypdjgbj .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#meiypdjgbj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#meiypdjgbj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#meiypdjgbj .gt_row_group_first td {
  border-top-width: 2px;
}

#meiypdjgbj .gt_row_group_first th {
  border-top-width: 2px;
}

#meiypdjgbj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#meiypdjgbj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#meiypdjgbj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#meiypdjgbj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#meiypdjgbj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#meiypdjgbj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#meiypdjgbj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#meiypdjgbj .gt_striped {
  background-color: #FAFAFA;
}

#meiypdjgbj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#meiypdjgbj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#meiypdjgbj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#meiypdjgbj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#meiypdjgbj .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#meiypdjgbj .gt_left {
  text-align: left;
}

#meiypdjgbj .gt_center {
  text-align: center;
}

#meiypdjgbj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#meiypdjgbj .gt_font_normal {
  font-weight: normal;
}

#meiypdjgbj .gt_font_bold {
  font-weight: bold;
}

#meiypdjgbj .gt_font_italic {
  font-style: italic;
}

#meiypdjgbj .gt_super {
  font-size: 65%;
}

#meiypdjgbj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#meiypdjgbj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#meiypdjgbj .gt_indent_1 {
  text-indent: 5px;
}

#meiypdjgbj .gt_indent_2 {
  text-indent: 10px;
}

#meiypdjgbj .gt_indent_3 {
  text-indent: 15px;
}

#meiypdjgbj .gt_indent_4 {
  text-indent: 20px;
}

#meiypdjgbj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>表&nbsp;18.3:  <p>正規表現と一緒に使う限量詞</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="限量詞">限量詞</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="text-align: center;" scope="col" id="意味">意味</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="限量詞" class="gt_row gt_left">?</td>
<td headers="意味" class="gt_row gt_left">直前の表現と0回以上一致（あってもなくてもよい）で、最大で1回一致</td></tr>
    <tr><td headers="限量詞" class="gt_row gt_left gt_striped">*</td>
<td headers="意味" class="gt_row gt_left gt_striped">直前の表現と0回以上一致</td></tr>
    <tr><td headers="限量詞" class="gt_row gt_left">+</td>
<td headers="意味" class="gt_row gt_left">直前の表現と1回以上一致</td></tr>
    <tr><td headers="限量詞" class="gt_row gt_left gt_striped">{m}</td>
<td headers="意味" class="gt_row gt_left gt_striped">直前の表現とちょうどm回一致</td></tr>
    <tr><td headers="限量詞" class="gt_row gt_left">{m,}</td>
<td headers="意味" class="gt_row gt_left">直前の表現とm回以上一致</td></tr>
    <tr><td headers="限量詞" class="gt_row gt_left gt_striped">{m,n}</td>
<td headers="意味" class="gt_row gt_left gt_striped">直前の表現とm回以上n回以下の一致</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>限量詞をつけない場合はちょうど1回一致である。</p>
<p>　これらの限量詞を使うと、指定した条件に一致する範囲において<strong>貪欲マッチング (greedy matching)</strong> が実行される。貪欲マッチングとは、パタンに一致するもののうち、できるだけ長いものとマッチしようとする性質である。たとえば、以下の例を見てみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>cats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"猫猫猫猫猫猫虎猫猫虎"</span>)</span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="fu">str_extract</span>(cats, <span class="at">pattern =</span> <span class="st">".+虎"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "猫猫猫猫猫猫虎猫猫虎"</code></pre>
</div>
</div>
<p>限量詞<code>+</code>で「何らかの文字」が<strong>1回以上</strong>出現した後に「虎」が1回（限量詞がないので、ちょうど1回）出現するパタンを抜き出したところ、先頭の猫から途中の虎を1回含んで最後の猫までを貪欲に抜き出した。</p>
<p>　同様に、次の例を見てみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">str_extract</span>(cats, <span class="at">pattern =</span> <span class="st">"猫+</span><span class="sc">\\</span><span class="st">w+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "猫猫猫猫猫猫虎猫猫虎"</code></pre>
</div>
</div>
<p>この例では、限量詞<code>+</code>で「猫」が<strong>1回以上</strong>出現した後に「何らかの文字」が<strong>1回以上</strong>出現するパタンを抜き出したところ、先頭の「猫」から6個の猫が貪欲に抜き出された後に、1回以上の何らかの文字として「虎猫猫虎」が抜き出された。結果として、文字列全体が抽出された。</p>
<p>　では、「猫虎」という2文字だけを抜き出したいときはどうすればいいのだろうか。そのような処理には、<strong>怠惰マッチング (lazy matching)</strong> を使う。怠惰マッチングを実行する際には、限量詞の後に<code>?</code> を付ける。 　 　たとえば、次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="fu">str_extract</span>(cats, <span class="at">pattern =</span> <span class="st">".+?虎"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "猫猫猫猫猫猫虎"</code></pre>
</div>
</div>
<p>限量詞<code>+</code>で「何らかの文字」が1回以上出現した後に「虎」が1回というパタンを指定しているが、前半の「1回以上」の部分を<code>+?</code>として怠惰マッチングにした効果として、（2回目ではなく）1回目の「虎」まででマッチングが終了している。ただし、「虎」の前についている「猫」の個数は1個ではないので注意が必要である。</p>
<p>　同様に、次の例を見てみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="fu">str_extract</span>(cats, <span class="at">pattern =</span> <span class="st">"猫+?</span><span class="sc">\\</span><span class="st">w+?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "猫猫"</code></pre>
</div>
</div>
<p>ここでは、「猫」を1回以上怠惰にマッチした後に、何らかの文字を1回以上怠惰にマッチするという指示をしている。結果として、最初の2文字「猫猫」の時点で条件を満たし、マッチングが完了している。</p>
<p>　<code>+?</code> だけでなく、<code>*?</code>、<code>??</code>、<code>{m,n}?</code> なども怠惰マッチングとして利用できる。</p>
<p>　例を用いて、正規表現の使い方をもう少し確認してみよう。練習のために、似たような文字列をいくつか含むベクトル <code>y_names</code> を用意する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>y_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yada"</span>, <span class="st">"Yano"</span>, <span class="st">"Yamada"</span>, <span class="st">"Yamaji"</span>, <span class="st">"Yamamoto"</span>, </span>
<span id="cb126-2"><a href="#cb126-2"></a>             <span class="st">"Yamashita"</span>, <span class="st">"Yamai"</span>, <span class="st">"Yanai"</span>, <span class="st">"Yanagi"</span>, <span class="st">"Yoshida"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>この中から、“Ya.a.+” というパタンに一致する文字列のみ抜き出そう（結果を見やすくするために、<code>unlist()</code>を使ってベクトルにする）。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a href="#cb127-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Ya.a.+"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-3"><a href="#cb127-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamada"    "Yamaji"    "Yamamoto"  "Yamashita" "Yamai"     "Yanai"    
[7] "Yanagi"   </code></pre>
</div>
</div>
<p>これらの文字列のみが抜き出された理由はわかるだろうか？たとえば、“Yada” が抜き出されなかったのはなぜだろうか？それは、パタンで指定した”Ya.a.+” の”.+“が、”Ya.a”の後に何らかの文字が1回以上出現することを要求しているからである。 したがって、その部分を”.?“に変えると、結果が変わる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a href="#cb129-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Ya.a.?"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-3"><a href="#cb129-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yada"  "Yamad" "Yamaj" "Yamam" "Yamas" "Yamai" "Yanai" "Yanag"</code></pre>
</div>
</div>
<p>　他のパタンもいくつか試してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb131-2"><a href="#cb131-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Ya.a.?i"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb131-3"><a href="#cb131-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamaji" "Yamai"  "Yanai"  "Yanagi"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb133-2"><a href="#cb133-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Y.+da"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb133-3"><a href="#cb133-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yada"    "Yamada"  "Yoshida"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Yama.+t.?"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb135-3"><a href="#cb135-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamamoto"  "Yamashita"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"Ya[:alpha:]{4}$"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamada" "Yamaji" "Yanagi"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"^</span><span class="sc">\\</span><span class="st">w{6,}$"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamada"    "Yamaji"    "Yamamoto"  "Yamashita" "Yanagi"    "Yoshida"  </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb141-2"><a href="#cb141-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"^[:alpha:]{6,8}$"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb141-3"><a href="#cb141-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamada"   "Yamaji"   "Yamamoto" "Yanagi"   "Yoshida" </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a>y_names <span class="sc">|&gt;</span> </span>
<span id="cb143-2"><a href="#cb143-2"></a>  <span class="fu">str_extract_all</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">w+m</span><span class="sc">\\</span><span class="st">w+"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb143-3"><a href="#cb143-3"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yamada"    "Yamaji"    "Yamamoto"  "Yamashita" "Yamai"    </code></pre>
</div>
</div>
</section>
<section id="文字列操作の例" class="level3" data-number="18.3.2">
<h3 data-number="18.3.2" class="anchored" data-anchor-id="文字列操作の例"><span class="header-section-number">18.3.2</span> 文字列操作の例</h3>
<p>例として、全国の市区役所と町村役場のデータ <code>Offices.csv</code>を読み込んで利用する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>Offices <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Offices.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1864 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): Code, Name, Zip, Address, Tel

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">head</span>(Offices, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Code  Name   Zip      Address                        Tel         
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                          &lt;chr&gt;       
1 01100 札幌市 060-8611 北海道札幌市中央区北1条西2丁目 011-211-2111
2 01202 函館市 040-8666 北海道函館市東雲町4-13         0138-21-3111
3 01203 小樽市 047-8660 北海道小樽市花園2-12-1         0134-32-4111</code></pre>
</div>
</div>
<p>このデータフレームには5つの列がある。このうち、<code>Address</code>に注目しよう。この列には、役所・役場の住所が記録されている。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a>Offices<span class="sc">$</span>Address[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "北海道札幌市中央区北1条西2丁目" "北海道函館市東雲町4-13"        
[3] "北海道小樽市花園2-12-1"         "北海道旭川市6条通9丁目"        
[5] "北海道室蘭市幸町1-2"           </code></pre>
</div>
</div>
<p>練習として、ここから都道府県名のみを抜き出してみよう。 当然ながら、都道府県名の末尾は「都」「道」「府」「県」のいずれかなので、「何らかの文字列を1回以上 (<code>\\w+)</code>」含み、その後に「都または道または府まはた県を1回 (<code>[都道府県]</code>)」というパタンを試してみよう（実は、これはうまくいかない）。 各都道府県を1回だけ抜き出すために、最後に<code>unique()</code>を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a>try1 <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb151-2"><a href="#cb151-2"></a>  <span class="fu">pull</span>(Address) <span class="sc">|&gt;</span> </span>
<span id="cb151-3"><a href="#cb151-3"></a>  <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">w+[都道府県]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb151-4"><a href="#cb151-4"></a>  <span class="fu">unique</span>()</span>
<span id="cb151-5"><a href="#cb151-5"></a><span class="fu">length</span>(try1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 111</code></pre>
</div>
</div>
<p>得られた都道府県の数が111になっており、「失敗」したことがわかる。結果を一部見てみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a>try1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道"                              
 [2] "北海道寿都郡寿都"                    
 [3] "北海道寿都"                          
 [4] "北海道虻田郡留寿都村字留寿都"        
 [5] "北海道中川郡音威子府村字音威子府"    
 [6] "北海道常呂郡訓子府"                  
 [7] "青森県"                              
 [8] "青森県下北郡大間町大字大間字奥戸下道"
 [9] "青森県三戸郡三戸町大字在府"          
[10] "青森県三戸郡階上町大字道"            </code></pre>
</div>
</div>
<p>抽出したすべての文字列の末尾が「都道府県」で終わっている。 つまり、私たちのRが（いつも通り！）私たちの指示に従ってくれたという意味において、この結果は決して失敗ではない。しかし、都道府県名のみを抽出するという私たちの希望通は叶えられなかった。 パタンの指示がまずかったのだ。</p>
<p>　<code>\\w+[都道府県]</code>というパタン指示では、<code>\\w+</code>の部分が貪欲マッチングになっている。 そのため、<code>[都道府県]</code>という文字を最後に含む文字列のうち、最も長い文字列が抽出されたのだ。</p>
<p>　貪欲マッチングを怠惰マッチングに変えて、もう1度試してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>try2 <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb155-2"><a href="#cb155-2"></a>  <span class="fu">pull</span>(Address) <span class="sc">|&gt;</span> </span>
<span id="cb155-3"><a href="#cb155-3"></a>  <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">w+?[都道府県]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb155-4"><a href="#cb155-4"></a>  <span class="fu">unique</span>()</span>
<span id="cb155-5"><a href="#cb155-5"></a><span class="fu">length</span>(try2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
</div>
<p>47の都道府県が抽出されたようだ。果たして、うまくいったのだろうか。 確認してみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a>try2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道"   "青森県"   "岩手県"   "宮城県"   "秋田県"   "山形県"  
 [7] "福島県"   "茨城県"   "栃木県"   "群馬県"   "埼玉県"   "千葉県"  
[13] "東京都"   "神奈川県" "新潟県"   "富山県"   "石川県"   "福井県"  
[19] "山梨県"   "長野県"   "岐阜県"   "静岡県"   "愛知県"   "三重県"  
[25] "滋賀県"   "京都"     "大阪府"   "兵庫県"   "奈良県"   "和歌山県"
[31] "鳥取県"   "島根県"   "岡山県"   "広島県"   "山口県"   "徳島県"  
[37] "香川県"   "愛媛県"   "高知県"   "福岡県"   "佐賀県"   "長崎県"  
[43] "熊本県"   "大分県"   "宮崎県"   "鹿児島県" "沖縄県"  </code></pre>
</div>
</div>
<p>この結果には1つ問題がある。基本的には都道府県名が「都道府県」までを含めて抽出されているが、京都府のみ「京都」になってしまった。これは、京都の「都」が「都道府県」にマッチしたためである。今回のパタン指示の問題はどこにあったのだろうか。問題は、「都」の前の「京」のみで、怠惰マッチングである<code>"\\w+?</code>に合致してしまった点にある。</p>
<p>　こういうときには、自分がもっている知識が役に立つことがある。私たちは、日本の都道府県名（末尾の<code>[都道府県]</code>を除く）が、2文字または3文字であることを知っている。この知識を使えば、「京」という1文字だけが取り出されるパタンを除外することができる。2文字以上3文字以下で怠惰マッチングを実行するために<code>{2,3}?</code>という限量詞を使う。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>try3 <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb159-2"><a href="#cb159-2"></a>  <span class="fu">pull</span>(Address) <span class="sc">|&gt;</span> </span>
<span id="cb159-3"><a href="#cb159-3"></a>  <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">w{2,3}?[都道府県]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb159-4"><a href="#cb159-4"></a>  <span class="fu">unique</span>()</span>
<span id="cb159-5"><a href="#cb159-5"></a><span class="fu">length</span>(try3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a>try3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道"   "青森県"   "岩手県"   "宮城県"   "秋田県"   "山形県"  
 [7] "福島県"   "茨城県"   "栃木県"   "群馬県"   "埼玉県"   "千葉県"  
[13] "東京都"   "神奈川県" "新潟県"   "富山県"   "石川県"   "福井県"  
[19] "山梨県"   "長野県"   "岐阜県"   "静岡県"   "愛知県"   "三重県"  
[25] "滋賀県"   "京都府"   "大阪府"   "兵庫県"   "奈良県"   "和歌山県"
[31] "鳥取県"   "島根県"   "岡山県"   "広島県"   "山口県"   "徳島県"  
[37] "香川県"   "愛媛県"   "高知県"   "福岡県"   "佐賀県"   "長崎県"  
[43] "熊本県"   "大分県"   "宮崎県"   "鹿児島県" "沖縄県"  </code></pre>
</div>
</div>
<p>これで、市区町村役場（所）の住所から、47都道府県の名前を抽出することができた。</p>
<p>ここから、末尾の<code>[道府県]</code>を取り除いてみよう（北海道はそのまま残す）。<code>str_replace()</code> を使って、特定の文字列を<code>""</code>（つまり、何も含まない文字列）に置換 (replace) する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>try3 <span class="sc">|&gt;</span> </span>
<span id="cb163-2"><a href="#cb163-2"></a>  <span class="fu">str_replace</span>(<span class="at">pattern =</span> <span class="st">"[都府県]"</span>,</span>
<span id="cb163-3"><a href="#cb163-3"></a>              <span class="at">replacement =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道" "青森"   "岩手"   "宮城"   "秋田"   "山形"   "福島"   "茨城"  
 [9] "栃木"   "群馬"   "埼玉"   "千葉"   "東京"   "神奈川" "新潟"   "富山"  
[17] "石川"   "福井"   "山梨"   "長野"   "岐阜"   "静岡"   "愛知"   "三重"  
[25] "滋賀"   "京府"   "大阪"   "兵庫"   "奈良"   "和歌山" "鳥取"   "島根"  
[33] "岡山"   "広島"   "山口"   "徳島"   "香川"   "愛媛"   "高知"   "福岡"  
[41] "佐賀"   "長崎"   "熊本"   "大分"   "宮崎"   "鹿児島" "沖縄"  </code></pre>
</div>
</div>
<p>ほとんどの都道府県については意図通りの結果が得られたが、「京都府」については「都」が取り除かれて「京府」になってしまった。これを防ぐためには、<code>[道府県]</code>が末尾にあることを<code>$</code>で指定すればよい。次のようにする。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>try3 <span class="sc">|&gt;</span> </span>
<span id="cb165-2"><a href="#cb165-2"></a>  <span class="fu">str_replace</span>(<span class="at">pattern =</span> <span class="st">"[都府県]$"</span>,</span>
<span id="cb165-3"><a href="#cb165-3"></a>              <span class="at">replacement =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "北海道" "青森"   "岩手"   "宮城"   "秋田"   "山形"   "福島"   "茨城"  
 [9] "栃木"   "群馬"   "埼玉"   "千葉"   "東京"   "神奈川" "新潟"   "富山"  
[17] "石川"   "福井"   "山梨"   "長野"   "岐阜"   "静岡"   "愛知"   "三重"  
[25] "滋賀"   "京都"   "大阪"   "兵庫"   "奈良"   "和歌山" "鳥取"   "島根"  
[33] "岡山"   "広島"   "山口"   "徳島"   "香川"   "愛媛"   "高知"   "福岡"  
[41] "佐賀"   "長崎"   "熊本"   "大分"   "宮崎"   "鹿児島" "沖縄"  </code></pre>
</div>
</div>
<p>これで望み通りの結果が得られた。</p>
<p>次に、<code>Offices</code> の <code>Tel</code>の列に注目しよう。 この列には、電話番号が記録されている。 ハイフンで番号が区切られているので、それを利用して市外局番を抜き出してみよう。 数字を1文字以上の怠惰マッチング (<code>\\d+?</code>) の後に、ハイフン1つとマッチング (<code>-</code>) するパタンを指定する。ただし、必要なのは数字だけなので、ハイフンまでを含む文字列を抽出した後、ハイフンを取り除く。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a>area_code <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb167-2"><a href="#cb167-2"></a>  <span class="fu">pull</span>(Tel) <span class="sc">|&gt;</span> </span>
<span id="cb167-3"><a href="#cb167-3"></a>  <span class="fu">str_extract</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">d+?-"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb167-4"><a href="#cb167-4"></a>  <span class="fu">str_replace</span>(<span class="at">pattern =</span> <span class="st">"-"</span>,</span>
<span id="cb167-5"><a href="#cb167-5"></a>              <span class="at">replacement =</span> <span class="st">""</span>)</span>
<span id="cb167-6"><a href="#cb167-6"></a><span class="fu">head</span>(area_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "011"  "0138" "0134" "0166" "0143" "0154"</code></pre>
</div>
</div>
<p>0から始まる数字が抜き出されている。市外局番の桁数を調べてみよう。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a>area_code <span class="sc">|&gt;</span> </span>
<span id="cb169-2"><a href="#cb169-2"></a>  <span class="fu">str_length</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-3"><a href="#cb169-3"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   2    3    4    5 
  40  500 1273   51 </code></pre>
</div>
</div>
<p>市外局番の桁数は、2桁から5桁までであることがわかる。ユニークな市外局番の個数は、</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>area_code <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> </span>
<span id="cb171-3"><a href="#cb171-3"></a>  <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 379</code></pre>
</div>
</div>
<p>である。</p>
<p>最後に、電話番号の下4桁を抜き出してみよう。 パタン一致の代わりに、<code>str_sub()</code> で最後から4文字目 (<code>-4</code>) から最後まで（<code>end</code> は指定しない）を抽出する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a>last4 <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a href="#cb173-2"></a>  <span class="fu">pull</span>(Tel) <span class="sc">|&gt;</span> </span>
<span id="cb173-3"><a href="#cb173-3"></a>  <span class="fu">str_sub</span>(<span class="at">start =</span> <span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb173-4"><a href="#cb173-4"></a><span class="fu">head</span>(last4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2111" "3111" "4111" "1111" "1111" "5151"</code></pre>
</div>
</div>
<p>念の為、すべての結果が4桁であることを確認する。 まず、4文字であることを確認する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a>last4 <span class="sc">|&gt;</span> </span>
<span id="cb175-2"><a href="#cb175-2"></a>  <span class="fu">str_length</span>() <span class="sc">|&gt;</span> </span>
<span id="cb175-3"><a href="#cb175-3"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   4 
1864 </code></pre>
</div>
</div>
<p>すべて4文字である。次に、すべてが数字であることを確認する。そのために<code>str_count()</code> で、特定のパタンに一致する回数を数える。ここでは、<code>pattern = "\\d"</code> で数字を指定し、その回数が4になることを確かめる。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a>last4 <span class="sc">|&gt;</span> </span>
<span id="cb177-2"><a href="#cb177-2"></a>  <span class="fu">str_count</span>(<span class="at">pattern =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">d"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb177-3"><a href="#cb177-3"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   4 
1864 </code></pre>
</div>
</div>
<p>すべの結果で数字が4回登場することが確認できた。文字の長さが4であることと合わせて、4桁の数字の抜き出しに成功したことがわかる。</p>
<p>ユニークな電話番号下4桁の個数は、</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>last4 <span class="sc">|&gt;</span> </span>
<span id="cb179-2"><a href="#cb179-2"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> </span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 365</code></pre>
</div>
</div>
<p>であり、下4桁については同じ番号が多く利用されていることがわかる。</p>
<p>北海道を例として、電話番号についてもう少し詳しく検討しよう。 そのために、まず北海道のデータを抜き出そう。住所 (<code>Address</code>) に「北海道」という文字列が含まれている行を、<code>dplyr::filter()</code> と<code>stringr::str_detect()</code> で抜き出す。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a>H <span class="ot">&lt;-</span> Offices <span class="sc">|&gt;</span> </span>
<span id="cb181-2"><a href="#cb181-2"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Address, <span class="at">pattern =</span> <span class="st">"北海道"</span>)) </span>
<span id="cb181-3"><a href="#cb181-3"></a><span class="fu">head</span>(H, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Code  Name   Zip      Address                        Tel         
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                          &lt;chr&gt;       
1 01100 札幌市 060-8611 北海道札幌市中央区北1条西2丁目 011-211-2111
2 01202 函館市 040-8666 北海道函館市東雲町4-13         0138-21-3111
3 01203 小樽市 047-8660 北海道小樽市花園2-12-1         0134-32-4111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1"></a><span class="fu">tail</span>(H, <span class="at">n =</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Code  Name     Zip      Address                        Tel         
  &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;                          &lt;chr&gt;       
1 01692 中標津町 086-1197 北海道標津郡中標津町丸山2-22   0153-73-3111
2 01693 標津町   086-1632 北海道標津郡標津町北2条西1-1-3 0153-82-2131
3 01694 羅臼町   086-1892 北海道目梨郡羅臼町栄町100-83   0153-87-2111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a><span class="fu">nrow</span>(H)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 179</code></pre>
</div>
</div>
<p>北海道には179の市区町村がある。このデータに対し、先程と同じ方法で電話番号の下4桁を抽出する。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a>H_last4 <span class="ot">&lt;-</span>  H <span class="sc">|&gt;</span> </span>
<span id="cb187-2"><a href="#cb187-2"></a>  <span class="fu">pull</span>(Tel) <span class="sc">|&gt;</span> </span>
<span id="cb187-3"><a href="#cb187-3"></a>  <span class="fu">str_sub</span>(<span class="at">start =</span> <span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb187-4"><a href="#cb187-4"></a>H_last4 <span class="sc">|&gt;</span> </span>
<span id="cb187-5"><a href="#cb187-5"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> </span>
<span id="cb187-6"><a href="#cb187-6"></a>  <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 58</code></pre>
</div>
</div>
<p>179の自治体に対し、電話番号下4桁のパタンは58しかない。 下2桁はどうだろうか？</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource r numberLines code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1"></a>H <span class="sc">|&gt;</span> </span>
<span id="cb189-2"><a href="#cb189-2"></a>  <span class="fu">pull</span>(Tel) <span class="sc">|&gt;</span> </span>
<span id="cb189-3"><a href="#cb189-3"></a>  <span class="fu">str_sub</span>(<span class="at">start =</span> <span class="sc">-</span><span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb189-4"><a href="#cb189-4"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 00  01  11  12  20  21  22  28  30  31  34  36  41  45  51  61  71  75  81  91 
  3   5 113   1   2  19   1   1   1  15   2   1   4   2   2   2   1   1   2   1 </code></pre>
</div>
</div>
<p>下2桁は全部で20パタンあるが、ほとんどの自治体で下2桁が「11」になっていることがわかる。 入力しやすい電話番号にしようという配慮だろう。</p>
</section>
</section>
<section id="文書データの分析" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="文書データの分析"><span class="header-section-number">18.4</span> 文書データの分析</h2>
<p>「吾輩は猫である」</p>
<p>　にゃーにゃーにゃにゃーにゃにゃにゃ！にゃーにゃー！</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/www\.jaysong\.net\/RBook\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tidydata.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">整然データ構造</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./visualization1.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">可視化 [理論]</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2023, <a href="https://www.jaysong.net">Jaehyun Song</a> and <a href="https://yukiyanai.github.io/">Yuki Yanai</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>